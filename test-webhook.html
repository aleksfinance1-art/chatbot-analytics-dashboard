<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç Webhook</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .container {
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        }
        h1 {
            color: #667eea;
            margin-bottom: 30px;
        }
        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            margin: 10px 5px;
            transition: transform 0.2s;
        }
        button:hover {
            transform: translateY(-2px);
        }
        button:active {
            transform: translateY(0);
        }
        #log {
            margin-top: 20px;
            padding: 15px;
            background: #f5f5f5;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            max-height: 400px;
            overflow-y: auto;
        }
        .success {
            color: #10b981;
            font-weight: bold;
        }
        .error {
            color: #ef4444;
            font-weight: bold;
        }
        .info {
            color: #3b82f6;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üß™ –¢–µ—Å—Ç Webhook –¥–ª—è –ø–µ—Ä–µ–ø–∏—Å–∫–∏</h1>
        <p>–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫–∏ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö:</p>
        
        <button onclick="sendDialog(1)">üì§ –°–æ–æ–±—â–µ–Ω–∏–µ #1</button>
        <button onclick="sendDialog(2)">üì§ –°–æ–æ–±—â–µ–Ω–∏–µ #2</button>
        <button onclick="sendDialog(3)">üì§ –°–æ–æ–±—â–µ–Ω–∏–µ #3</button>
        <button onclick="sendDialog(4)">üì§ –°–æ–æ–±—â–µ–Ω–∏–µ #4</button>
        <button onclick="sendDialog(5)">üì§ –°–æ–æ–±—â–µ–Ω–∏–µ #5</button>
        <button onclick="sendAllDialogs()">üöÄ –û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤—Å—ë</button>
        <button onclick="clearLog()">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥</button>
        
        <div id="log"></div>
    </div>

    <script>
        const WEBHOOK_URL = 'https://functions.poehali.dev/f62e29ad-f517-47b1-aafd-269884a49479';
        
        const dialogs = [
            {
                telegram_id: 999888777,
                name: '–ò–≤–∞–Ω –¢–µ—Å—Ç–æ–≤—ã–π',
                username: 'ivan_test',
                email: 'ivan@test.ru',
                premium: true,
                tokens: 1200,
                model: 'GPT-4',
                user_message: '–ü—Ä–∏–≤–µ—Ç! –ö–∞–∫ —Å–æ–∑–¥–∞—Ç—å —Ç–µ–ª–µ–≥—Ä–∞–º –±–æ—Ç–∞ –Ω–∞ Python?',
                assistant_message: '–ü—Ä–∏–≤–µ—Ç! –î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–µ–ª–µ–≥—Ä–∞–º –±–æ—Ç–∞ –Ω–∞ Python —Ç–µ–±–µ –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ python-telegram-bot. –í–æ—Ç –±–∞–∑–æ–≤—ã–π –ø—Ä–∏–º–µ—Ä:\n\n```python\nfrom telegram import Update\nfrom telegram.ext import Application, CommandHandler\n\nasync def start(update, context):\n    await update.message.reply_text("–ü—Ä–∏–≤–µ—Ç!")\n\napp = Application.builder().token("YOUR_TOKEN").build()\napp.add_handler(CommandHandler("start", start))\napp.run_polling()\n```\n\n–£—Å—Ç–∞–Ω–æ–≤–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫—É: pip install python-telegram-bot'
            },
            {
                telegram_id: 999888777,
                name: '–ò–≤–∞–Ω –¢–µ—Å—Ç–æ–≤—ã–π',
                username: 'ivan_test',
                premium: true,
                tokens: 850,
                model: 'GPT-4',
                user_message: '–ê –∫–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫–∏ –≤ –±–æ—Ç–∞?',
                assistant_message: '–î–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–Ω–æ–ø–æ–∫ –∏—Å–ø–æ–ª—å–∑—É–π InlineKeyboardMarkup:\n\n```python\nfrom telegram import InlineKeyboardButton, InlineKeyboardMarkup\n\nkeyboard = [\n    [InlineKeyboardButton("–ö–Ω–æ–ø–∫–∞ 1", callback_data="1")],\n    [InlineKeyboardButton("–ö–Ω–æ–ø–∫–∞ 2", callback_data="2")]\n]\nreply_markup = InlineKeyboardMarkup(keyboard)\nawait update.message.reply_text("–í—ã–±–µ—Ä–∏:", reply_markup=reply_markup)\n```\n\n–¢–∞–∫–∂–µ –¥–æ–±–∞–≤—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ CallbackQueryHandler –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –Ω–∞–∂–∞—Ç–∏–π.'
            },
            {
                telegram_id: 999888777,
                name: '–ò–≤–∞–Ω –¢–µ—Å—Ç–æ–≤—ã–π',
                username: 'ivan_test',
                premium: true,
                tokens: 950,
                model: 'openai/gpt-4.1-mini',
                user_message: '–ö–∞–∫ –ø–æ–¥–∫–ª—é—á–∏—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –∫ –±–æ—Ç—É?',
                assistant_message: '–†–µ–∫–æ–º–µ–Ω–¥—É—é –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å SQLite –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤ –∏–ª–∏ PostgreSQL –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞. –ü—Ä–∏–º–µ—Ä —Å SQLite:\n\n```python\nimport sqlite3\n\nconn = sqlite3.connect("bot.db")\ncursor = conn.cursor()\n\ncursor.execute("""\n    CREATE TABLE IF NOT EXISTS users (\n        user_id INTEGER PRIMARY KEY,\n        username TEXT,\n        created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n    )\n""")\n\nconn.commit()\n```\n\n–î–ª—è PostgreSQL –∏—Å–ø–æ–ª—å–∑—É–π –±–∏–±–ª–∏–æ—Ç–µ–∫—É psycopg2 –∏–ª–∏ asyncpg –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π —Ä–∞–±–æ—Ç—ã.'
            },
            {
                telegram_id: 999888777,
                name: '–ò–≤–∞–Ω –¢–µ—Å—Ç–æ–≤—ã–π',
                username: 'ivan_test',
                premium: true,
                tokens: 1100,
                model: 'GPT-4',
                user_message: '–ú–æ–∂–Ω–æ –ª–∏ –¥–æ–±–∞–≤–∏—Ç—å –æ–ø–ª–∞—Ç—É –≤ –±–æ—Ç–∞?',
                assistant_message: '–î–∞! –í Telegram –µ—Å—Ç—å –≤—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –ø–ª–∞—Ç–µ–∂–µ–π. –û—Å–Ω–æ–≤–Ω—ã–µ —Å–ø–æ—Å–æ–±—ã:\n\n1. **Telegram Payments API** - –ø—Ä–∏–Ω–∏–º–∞–π –ø–ª–∞—Ç–µ–∂–∏ —á–µ—Ä–µ–∑ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤ (Stripe, –ÆKassa –∏ –¥—Ä.)\n2. **–ö—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–∞** - TON, Bitcoin —á–µ—Ä–µ–∑ –≤–Ω–µ—à–Ω–∏–µ —Å–µ—Ä–≤–∏—Å—ã\n3. **–≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã–µ –∫–æ—à–µ–ª—å–∫–∏** - Robokassa, PayPal\n\n–ü—Ä–∏–º–µ—Ä —Å Telegram Payments:\n```python\nfrom telegram import LabeledPrice\n\nawait context.bot.send_invoice(\n    chat_id=update.effective_chat.id,\n    title="–ü—Ä–µ–º–∏—É–º –¥–æ—Å—Ç—É–ø",\n    description="–ú–µ—Å—è—Ü –ø—Ä–µ–º–∏—É–º –ø–æ–¥–ø–∏—Å–∫–∏",\n    payload="premium_month",\n    provider_token=PAYMENT_TOKEN,\n    currency="RUB",\n    prices=[LabeledPrice("–ü–æ–¥–ø–∏—Å–∫–∞", 50000)]  # 500 —Ä—É–±\n)\n```'
            },
            {
                telegram_id: 999888777,
                name: '–ò–≤–∞–Ω –¢–µ—Å—Ç–æ–≤—ã–π',
                username: 'ivan_test',
                premium: true,
                tokens: 750,
                model: 'GPT-4',
                user_message: '–°–ø–∞—Å–∏–±–æ –∑–∞ –ø–æ–º–æ—â—å! üöÄ',
                assistant_message: '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞! –†–∞–¥ –±—ã–ª –ø–æ–º–æ—á—å! üòä\n\n–ï—Å–ª–∏ –±—É–¥—É—Ç –µ—â—ë –≤–æ–ø—Ä–æ—Å—ã –ø–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –±–æ—Ç–∞ - –æ–±—Ä–∞—â–∞–π—Å—è. –£–¥–∞—á–∏ —Å –ø—Ä–æ–µ–∫—Ç–æ–º! üéâ\n\nP.S. –ù–µ –∑–∞–±—É–¥—å –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –±–æ—Ç–∞ –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω –∏ –¥–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫.'
            }
        ];

        function log(message, type = 'info') {
            const logDiv = document.getElementById('log');
            const time = new Date().toLocaleTimeString('ru-RU');
            const className = type;
            logDiv.innerHTML += `<div class="${className}">[${time}] ${message}</div>`;
            logDiv.scrollTop = logDiv.scrollHeight;
        }

        async function sendDialog(index) {
            const dialog = dialogs[index - 1];
            log(`–û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è #${index}...`, 'info');
            
            try {
                const response = await fetch(WEBHOOK_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(dialog)
                });
                
                const result = await response.json();
                
                if (response.ok) {
                    log(`‚úÖ –°–æ–æ–±—â–µ–Ω–∏–µ #${index} —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ! Dialog ID: ${result.dialog_id}`, 'success');
                } else {
                    log(`‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ #${index}: ${JSON.stringify(result)}`, 'error');
                }
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ —Å–µ—Ç–∏ #${index}: ${error.message}`, 'error');
            }
        }

        async function sendAllDialogs() {
            log('üöÄ –ù–∞—á–∏–Ω–∞—é –æ—Ç–ø—Ä–∞–≤–∫—É –≤—Å–µ—Ö —Å–æ–æ–±—â–µ–Ω–∏–π...', 'info');
            for (let i = 1; i <= dialogs.length; i++) {
                await sendDialog(i);
                await new Promise(resolve => setTimeout(resolve, 500));
            }
            log('üéâ –í—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã!', 'success');
        }

        function clearLog() {
            document.getElementById('log').innerHTML = '';
        }

        log('‚ú® –ì–æ—Ç–æ–≤ –∫ –æ—Ç–ø—Ä–∞–≤–∫–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö', 'info');
    </script>
</body>
</html>
